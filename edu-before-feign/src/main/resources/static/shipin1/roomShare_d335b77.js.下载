define("widget/roomShare",function(require,exports,module){function Share(cfg){var _this=this;this.paramObJ=cfg;var cssText=".share-box .share-bd{height:205px;margin:10px 0 0 5px}.share-box .share-wx{width:174px;float:left;height:100%;border-right:1px solid #f3f3f3}.share-box .share-wx .wx-face{width:162px;height:58px;display:block;background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/wx-face_b1ffe50.png?__sprite) no-repeat}.share-box .share-wx .qr-code-wrap{width:138px;height:138px;border:1px solid #f0f0f0;position:relative;margin-left:13px}.share-box .share-wx .qr-code-wrap .wx-icon{width:26px;height:26px;position:absolute;left:50%;top:50%;margin:-13px 0 0 -13px;background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/wx-icon_b94e584.png?__sprite) no-repeat}.share-box .share-cnt{margin-left:20px;float:left}.share-box .share-cnt .share-list{margin:21px 0}.share-box .share-cnt .share-list span{float:left;width:40px;height:40px;margin-right:25px;cursor:pointer}.share-box .share-cnt .share-list .wb-icon{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/wb-icon_5d69f3f.png?__sprite) no-repeat}.share-box .share-cnt .share-list .wb-icon:hover{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/wb-icon-hover_e387553.png?__sprite) no-repeat}.share-box .share-cnt .share-list .qq-icon{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/qq-icon_8e1c739.png?__sprite) no-repeat}.share-box .share-cnt .share-list .qq-icon:hover{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/qq-icon-hover_4891a88.png?__sprite) no-repeat}.share-box .share-cnt .share-list .qzone-icon{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/qzone-icon_7ed7432.png?__sprite) no-repeat}.share-box .share-cnt .share-list .qzone-icon:hover{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/qzone-icon-hover_d658de2.png?__sprite) no-repeat}.share-box .share-cnt .share-list .tb-icon{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/tb-icon_6fa318a.png?__sprite) no-repeat}.share-box .share-cnt .share-list .tb-icon:hover{background:url(https://a.msstatic.com/huya/main/widget/roomShare/img/tb-icon-hover_49889d3.png?__sprite) no-repeat}.share-box .share-cnt .share-link .share-link-item{zoom:1;height:30px;border:1px solid #e9e7e8;width:233px;border-radius:3px;line-height:30px;overflow:hidden;text-align:center;margin-bottom:10px}.share-box .share-cnt .share-link .share-link-input{width:135px;height:30px;line-height:30px;color:#767676;float:left;border:0;padding:0 2px}.share-box .share-cnt .share-link .share-copy-btn{float:left;width:94px;background:#ebe9ea;height:100%;color:#565656;cursor:pointer}.share-box .share-cnt .share-link .share-copy-btn:hover{background:#f80;color:#fff}.share-box .share-cnt .share-link .share-copy-btn-hover{background:#f80;color:#fff}";tools.importStyle(cssText,"J_shareStyle");var tmpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{}){__p+="";var playerUrl="http://liveshare.huya.com/iframe/"+TT.createRoomHost(obj.privateHost,obj.profileRoom,obj.yyid);__p+='\n<div class="share-box">\n    <div class="share-bd clearfix">\n        <div class="share-wx">\n            <span class="wx-face"></span>\n            <div class="qr-code-wrap">\n                <span class="wx-icon"></span>\n                <div id="scan-region-qrcode"></div>\n            </div>\n        </div>\n        <div class="share-cnt">\n            <div class="share-list clearfix">\n                <span title="\u5206\u4eab\u5230\u65b0\u6d6a\u5fae\u535a" data-platform="3" class="wb-icon clickstat" eid="click/share/3/'+(null==(__t=obj.roomPid)?"":__t)+'" eid_desc="\u70b9\u51fb/\u5206\u4eab/\u5fae\u535a/\u4e3b\u64aduid"></span>\n                <span title="\u5206\u4eab\u5230QQ" data-platform="4" class="qq-icon clickstat" eid="click/share/4/'+(null==(__t=obj.roomPid)?"":__t)+'" eid_desc="\u70b9\u51fb/\u5206\u4eab/QQ/\u4e3b\u64aduid"></span>\n                <span title="\u5206\u4eab\u5230QQ\u7a7a\u95f4" data-platform="5" class="qzone-icon clickstat" eid="click/share/5/'+(null==(__t=obj.roomPid)?"":__t)+'" eid_desc="\u70b9\u51fb/\u5206\u4eab/QQ\u7a7a\u95f4/\u4e3b\u64aduid"></span>\n                <span title="\u5206\u4eab\u5230\u8d34\u5427" data-platform="6" class="tb-icon clickstat" eid="click/share/6/'+(null==(__t=obj.roomPid)?"":__t)+'" eid_desc="\u70b9\u51fb/\u5206\u4eab/\u8d34\u5427/\u4e3b\u64aduid"></span>\n            </div>\n            <ul class="share-link">\n                <li class="share-link-item">\n                    <input type="text" value="'+(null==(__t=TT.app.main+TT.createRoomHost(obj.privateHost,obj.profileRoom,obj.yyid))?"":__t)+'" id="room-link" class="share-link-input">\n                    <span class="share-copy-btn" data-clipboard-action="copy" data-clipboard-target="#room-link" eid="click/Live/liveURL" eid_desc="\u70b9\u51fb/\u76f4\u64ad\u95f4/\u590d\u5236\u76f4\u64ad\u95f4\u5730\u5740">\u590d\u5236\u76f4\u64ad\u95f4\u5730\u5740</span>\n                </li>\n                ',1!=obj.isLive&&(__p+='\n                    <li class="share-link-item">\n                        <input type="text" value="'+(null==(__t=playerUrl)?"":__t)+'" id="flash-link" class="share-link-input">\n                        <span class="share-copy-btn" data-clipboard-action="copy" data-clipboard-target="#flash-link" eid="click/Live/vURL" eid_desc="\u70b9\u51fb/\u76f4\u64ad\u95f4/\u590d\u5236\u64ad\u653e\u5668\u5730\u5740">\u590d\u5236\u64ad\u653e\u5668\u5730\u5740</span>\n                    </li>\n                    <li class="share-link-item">\n                        <input type="text" value="<iframe width=&quot;100%&quot; height=&quot;100%&quot;  frameborder=&quot;0&quot; scrolling=&quot;no&quot; src=&quot;'+(null==(__t=playerUrl)?"":__t)+'&quot;></iframe>" id="flash-code" class="share-link-input">\n                        <span class="share-copy-btn" data-clipboard-action="copy" data-clipboard-target="#flash-code" eid="click/Live/vCode" eid_desc="\u70b9\u51fb/\u76f4\u64ad\u95f4/\u590d\u5236\u64ad\u653e\u5668\u4ee3\u7801">\u590d\u5236\u64ad\u653e\u5668\u4ee3\u7801</span>\n                    </li>    \n               '),__p+="\n            </ul>  \n        </div>\n    </div>\n</div>"}return __p};$("#pop-box-share").append(tmpl(cfg)),$("#scan-region-qrcode").qrcode({render:"Microsoft Internet Explorer"==navigator.appName?"table":"canvas",text:"http://rel.huya.com/room?sid="+cfg.chTopId+"&subsid="+cfg.subChId+"&presenteruid="+cfg.roomPid+"&utm=w&sourceType="+cfg.iSourceType+"&screenType="+cfg.screenType,width:138,height:138}),_this.copyFn(),_this.shareEvent()}var tools=require("tools"),TTR=require("TTR"),TTA=require("TTA"),Toast=require("widget/dialog").toast;require("qrcode"),Share.prototype={copyFn:function(){function e(){t&&t.close(),t=Toast.suc("\u5df2\u6210\u529f\u590d\u5236\u5230\u60a8\u7684\u526a\u5207\u9762\u677f")}window.clipboardData?$(".share-copy-btn").on("click",function(){var t=$(this).attr("data-clipboard-target");e(),window.clipboardData.setData("Text",$(t).val())}):$.ajax({url:"https://a.msstatic.com/huya/main/lib/clipboard_b3c0b7d.js",dataType:"script",cache:!0}).done(function(){var t=new Clipboard(".share-copy-btn");t.on("success",function(){e();try{ya.reportProductEvent({eid:$(this).attr("eid"),eid_desc:$(this).attr("eid_desc")})}catch(t){}})});var t=null},shareEvent:function(){function e(e,t){var i=encodeURIComponent(t.sAction),o=encodeURIComponent(t.sTitle),r=encodeURIComponent(t.sContent),n=encodeURIComponent(t.sImageUrl);return a[e](i,o,r,n)}var t=this,a={3:function(e,t,a,i){return"http://service.weibo.com/share/share.php?url="+e+"&title="+t+"&pic="+i+"&language=zh_cn"},4:function(e,t,a,i){return"http://connect.qq.com/widget/shareqq/index.html?url="+e+"&desc="+a+"&title="+t+"&pics="+i+"&summary="+a},5:function(e,t,a,i){return"http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+e+"&title="+t+"&pics="+i+"&summary="+a},6:function(e,t,a,i){return"http://tieba.baidu.com/f/commit/share/openShareApi?title="+t+"&url="+e+"&to=tieba&type=text&relateUid=&pics="+i+"&key=&sign=on&desc=&comment="+a}};$("#pop-box-share").find(".share-list").on("click","span",function(){var a=$(this),i=a.data("platform");t.getLiveShareInfo(i,function(t){var a=e(i,t);window.open(a,"_blank")})})},getLiveShareInfo:function(e,t){$.ajax({url:TT.app.main+"member/index.php?m=Share&do=getLiveShareInfo",type:"GET",dataType:"json",async:!1,data:{uid:this.paramObJ.roomPid,action:location.href,platform:e}}).done(function(e){200==e.status&&t&&t(e.data)})}},module.exports=function(){new Share({chTopId:TTR.id,subChId:TTR.sid,screenType:TTR.screenType,iSourceType:TTR.liveSourceType,privateHost:TTR.privateHost,profileRoom:TTR.profileRoom,yyid:TTA.yyid,isLive:TTR.isOff,roomPid:TTA.lp})}});