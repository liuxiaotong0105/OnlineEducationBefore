define("widget/roomMsgOfKing",function(require,exports,module){function onMsg(o){var e=0,n=o.vDecorationPrefix.value;if(n.length&&$.each(n,function(o,n){10200==n.iAppId&&(e=n.vData.iLevel)}),4==e||5==e||6==e){var t=createMsg(o,e);processor.process(function(o){container.append(t),container.addClass("in"),setTimeout(function(){container.removeClass("in"),container.addClass("out"),setTimeout(function(){container.removeClass("out"),container.empty(),o()},600)},processor.size()<10?5e3:3e3)})}}function createMsg(o,e){importStyle();var n=o.sContent;try{n=decodeURIComponent(n)}catch(t){}n=xss(n),n=Emot.replace(n);var i=o.tUserInfo.sNickName;try{i=decodeURIComponent(i)}catch(t){}i=xss(i);var a=fontColorParse(o.tFormat.iFontColor),r="",s=o.vDecorationPrefix.value;s.length&&$.each(s,function(o,e){0==e.iViewType&&EDecorationAppType[e.iAppId]&&(r+=EDecorationAppType[e.iAppId](e.vData)),1==e.iViewType&&(r+=textPendantParse(e.vData)),2==e.iViewType&&(r+='<img src="'+TT.trimUrl(e.vData.sUrl).replace(".png","_3.png")+'" />')});var l="",c=o.vDecorationSuffix.value;return c.length&&$.each(c,function(o,e){if(2==e.iViewType){var n=e.vData.sUrl;if(n){var t=n.lastIndexOf(".");l+='<img src="'+TT.trimUrl(n.slice(0,t))+"_3"+n.slice(t)+'">'}}}),tpl({lv:e,name:i,msg:n,decorationPrefix:r,decorationSuffix:l,color:0!=a?' style="color: #'+a+';"':""})}function xss(o){return"string"!=typeof o?o:o=o.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&#39;").replace(/\"/g,"&quot;")}function textPendantParse(o){var e=o.iColor>0?" color: #"+fontColorParse(o.iColor)+";":"";return'<span style="display: inline-block; line-height: 20px;'+e+'">'+o.sText+"</span>"}function fontColorParse(o){if(o>0){var e=o.toString(16);if(e.length<6){for(var n=6-e.length,t="",i=0;n>i;i++)t+="0";o=t+e}else o=e}else o=0;return o}var tools=require("tools"),Emot=require("Emot"),Processor=require("ProcessorClass"),chat=require("chat"),mySelfSpeakCfg=require("chat/mySelfSpeakCfg"),roomBlockWords=require("roomBlockWords"),fansIcon=require("widget/fans-icon"),chatPanelFilter=require("chatPanelFilter"),processor=new Processor(1),container=$("#J_box_msgOfKing");chatPanelFilter.on("update",function(){setTimeout(function(){var o=chatPanelFilter.topPanel(),e=$("#wrap-"+o).height();container.css("top",e+("income"==o?16:0))},250)}),chat.speak.on("speak",function(o){mySelfSpeakCfg.get(function(e){e.sContent=o,onMsg(e)})}),chat.broadcaster.addListener(function(o){o.isOwn||roomBlockWords.testMsg(o.data)||onMsg(o.data)});var tpl=function(obj){{var __t,__p="";Array.prototype.join}with(obj||{})__p+='<div class="msg-of-king lv-'+(null==(__t=lv)?"":__t)+'">\n    <div class="inner">\n        <div class="content">\n            <p class="decorationPrefix">'+(null==(__t=decorationPrefix)?"":__t)+'</p>\n            <span class="name" title="\u70b9\u51fb\u67e5\u770b\u4e2a\u4eba\u4fe1\u606f">'+(null==(__t=name)?"":__t)+'</span>\n            <p class="decorationSuffix">'+(null==(__t=decorationSuffix)?"":__t)+'</p>\n            <span class="colon">:</span>\n            <span class="msg"'+(null==(__t=color)?"":__t)+">"+(null==(__t=msg)?"":__t)+"</span>\n        </div>\n    </div>\n</div>\n";return __p},cssText='@charset "UTF-8";@keyframes msgOfKingFadeInDown{from{opacity:0;transform:translate3d(0,-100%,0)}to{opacity:1;transform:translate3d(0,0,0)}}@keyframes msgOfKingFadeOutUp{from{opacity:1}to{opacity:0;transform:translate3d(0,-100%,0)}}.msgOfKing_box{position:absolute;z-index:6;top:0;left:0;width:100%}.msgOfKing_box.in{animation-name:msgOfKingFadeInDown;animation-duration:.5s;animation-fill-mode:both}.msgOfKing_box.out{animation-name:msgOfKingFadeOutUp;animation-duration:.5s;animation-fill-mode:both}.msg-of-king{line-height:22px;font-size:14px}.msg-of-king:after{position:absolute;content:"";z-index:-1;width:100%;height:1px;box-shadow:0 0 12px rgba(0,0,0,.6)}.msg-of-king .inner{display:table-cell;vertical-align:middle;padding:4px 46px 0 12px;-moz-box-sizing:border-box;box-sizing:border-box;height:52px;width:338px}.msg-of-king .content{display:inline-block;width:100%;overflow:hidden;zoom:1}.msg-of-king .content .name{vertical-align:middle;display:inline-block;max-width:8em;overflow:hidden;white-space:nowrap;word-wrap:normal;text-overflow:ellipsis;color:#3c9cfe;cursor:pointer}.msg-of-king .content .colon{color:#3c9cfe;padding:0 .5em 0 .3em}.msg-of-king .content .decorationPrefix{display:inline-block;vertical-align:middle;line-height:0}.msg-of-king .content .decorationPrefix span{vertical-align:middle;margin-right:3px}.msg-of-king .content .decorationPrefix .fans-icon{position:relative;left:0;top:-2px}.msg-of-king .content .decorationPrefix img{vertical-align:middle;margin-right:3px;height:auto;max-height:22px}.msg-of-king .content .decorationSuffix{display:inline-block;vertical-align:middle;line-height:0}.msg-of-king .content .decorationSuffix img{vertical-align:middle;margin-left:3px;height:auto;max-height:22px}.msg-of-king .content .msg{word-break:break-all;word-wrap:break-word}.msg-of-king.lv-6{border-top:1px solid #F5D96B;border-bottom:1px solid #F5D96B;background:url(https://a.msstatic.com/huya/main/widget/roomMsgOfKing/img/6_558e4d4.png) #FFFCE9 right bottom no-repeat}.msg-of-king.lv-5{border-top:1px solid #F3DBFF;border-bottom:1px solid #F3DBFF;background:url(https://a.msstatic.com/huya/main/widget/roomMsgOfKing/img/5_a8d4c47.png) #FFF3FE right bottom no-repeat}.msg-of-king.lv-4{border-top:1px solid #FAD2D9;border-bottom:1px solid #FAD2D9;background:url(https://a.msstatic.com/huya/main/widget/roomMsgOfKing/img/4_1f37669.png) #FFF5F7 right bottom no-repeat}',importStyle=tools.once(function(){tools.importStyle(cssText,"J_msgOfKing_tyle")}),EDecorationAppType={10100:function(o){var e="";return 1==o.iType&&(e='<span class="admin-icon admin-icon-1"></span>'),2==o.iType&&(e='<span class="admin-icon admin-icon-0"></span>'),e},10400:function(o){return fansIcon.create(o.iBadgeLevel,1==o.iBadgeType?o.tFaithInfo.sFaithName:o.sBadgeName,o.lBadgeId,o.iBadgeType)}}});