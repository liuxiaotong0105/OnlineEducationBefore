define("subscribeByTaf",function(i,e,a){function t(){$.extend(this,new n);this.initialize.apply(this,arguments)}var n=i("Event"),u=i("TTP"),r=(i("TTA"),!1),s=null,o=t.prototype;o.initialize=function(){var i=this;TT.getUserInfo(function(e){r=e.isLogined,s=e,i.listenFromPlayer()})},o.addSubscribe=function(i,e){var a=this;return r?void(u.isH5?u.ready(function(t){var n=new HUYA.ModRelationReq;n.tId=t.userId,n.lUid=i,n.iOp=1,t.sendWup2("huyauserui","addSubscribe",n,function(t){var n=1==t.iNewRelation||3==t.iNewRelation;n&&(a.emit("add",i),u.call("subscribeStatusChange",{iStatus:1,uid:i}),e&&e(t))})}):(u.one("addSubscribeRsp",function(t){var n=1==t.param.rsp.iNewRelation||3==t.param.rsp.iNewRelation;n&&(a.emit("add",i),u.call("subscribeStatusChange",{iStatus:1,uid:i}),e&&e(t.param))}),u.call("addSubscribe",{iRequestId:i,lUid:i,iOp:1}))):void TT.login.login()},o.delSubscribe=function(i,e){var a=this;return r?void(u.isH5?u.ready(function(t){var n=new HUYA.ModRelationReq;n.tId=t.userId,n.lUid=i,n.iOp=2,t.sendWup2("huyauserui","delSubscribe",n,function(t){var n=1==t.iNewRelation||3==t.iNewRelation;n||(a.emit("del",i),u.call("subscribeStatusChange",{iStatus:0,uid:i}),e&&e(t))})}):(u.one("delSubscribeRsp",function(t){var n=1==t.param.rsp.iNewRelation||3==t.param.rsp.iNewRelation;n||(a.emit("del",i),u.call("subscribeStatusChange",{iStatus:0,uid:i}),e&&e(t.param))}),u.call("delSubscribe",{iRequestId:i,lUid:i,iOp:2}))):void TT.login.login()},o.getRelationBatch=function(i,e){return r?void(u.isH5?u.ready(function(a){var t=new Taf.Vector(new Taf.INT64);t.value=i;var n=new HUYA.GetRelationBatchReq;n.tId=a.userId,n.vUid=t,a.sendWup2("huyauserui","getRelationBatch",n,function(i){e&&e(i.mItem.value)})}):(u.one("getRelationBatchRsp",function(i){e&&e(i.param.mItem.value)}),u.call("getRelationBatch",{vUid:i}))):void TT.login.login()},o.listenFromPlayer=function(){var i=this;u.on("subscribeStatusChange",function(e){var a=e.param?e.param:e;1==a.iStatus?i.emit("add",a.uid):i.emit("del",a.uid)})},o.constructor=t;var d=new t;a.exports=d});