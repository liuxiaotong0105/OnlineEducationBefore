define("widget/vipSeat",function(require,exports,module){var TTP=require("TTP"),tab=require("rankTab"),ucard=require("widget/ucard"),tools=require("tools"),fansIcon=require("widget/fans-icon");require("jScrollPane");var debounce=tools.debounce,vipModel=require("roomVip"),Rank=function(data){function render(e){var t=e.list.length;seats.html(tpl({data:e.list,sBadgeName:e.sBadgeName,sVLogo:e.sVLogo})),e.total>t?tips.text("\u4f59\u4e0b "+(e.total-t)+" \u4f4d\u8d35\u5bbe\u672a\u88ab\u5c55\u793a\uff0c\u5347\u7ea7\u8d35\u65cf\u6216\u5b88\u62a4\u53ef\u63d0\u5347\u6392\u540d").show():tips.hide(),scrollbar?size!=t&&scrollbarSetup():scrollbarSetup(),size=t,vipSeat[0>=size?"addClass":"removeClass"]("vipSeat-empty"),vipSeat[size>0&&3>size?"addClass":"removeClass"]("vipSeat-less")}function bind(){$(".J_nobleBuy").on("click",function(e){e.preventDefault(),require.async("noble",function(e){e.open()})});var e=null,t=vipSeat.closest(".week-rank__unit").removeClass("loading"),i=t.height();vipSeat.on("mouseenter",function(){var a=vipSeat.height();a>i&&(e&&clearTimeout(e),e=setTimeout(function(){t.stop().animate({height:a})},300))}).on("mouseleave",function(){e&&clearTimeout(e),t&&t.stop().animate({height:i})}),TTP.ready(function(){var e;vipSeat.on("mouseenter",".J_name",e=debounce(function(t){var i=null,a=null,n=$(window).scrollLeft()+Math.min(t.clientX+15,$(window).width()-260),o=$(window).scrollTop()+Math.min(t.clientY+10,$(window).height()-340),l=$(this).closest(".seat-item"),s=viper.list[l.index()];s&&ucard({uid:s.lUid,muteText:"\u8d35\u5bbe\u5e2d",init:function(t){a=t,t.view.css({left:n,top:o,zIndex:10,position:"absolute"}),t.view.find(".ucard-x").hide(),t.view.on("mouseenter",function(){clearTimeout(i),e.cancel()}).on("mouseleave",function(){t.destroy()}),t.view.appendTo("body");try{ya.reportProductEvent({eid:"click/zhibo/kp/xcgb",eid_desc:"\u70b9\u51fb/\u76f4\u64ad/\u7528\u6237\u5361\u7247/\u8d35\u5bbe"})}catch(l){}}}),l.on("mouseleave",function(){i=setTimeout(function(){a&&a.destroy()},200)})},800)).on("mouseleave",function(){e&&e.cancel()})})}function update(e){viper=e,render(e)}var viper=data,tpl=function(obj){function creatGuardIcon(e){if(!$.isNumeric(e))return"";e=parseInt(e,10);for(var t=[1,12,520,1314],i=-1,a=0,n=t.length;n>a&&e>=t[a];a++)i++;return i>-1?'<span class="sh-icon sh-icon'+(i+1)+'"></span>':""}{var __t,__p="";Array.prototype.join}with(obj||{}){if(__p+="",data&&data.length){for(var user=null,i=0,l=data.length;l>i;i++){user=data[i];var iNobleLevel=user.tNobleInfo.iNobleLevel,iGuardLevel=user.tGuardInfo.iGuardLevel,iBadgeLevel=user.tFansInfo.iBadgeLevel,lBadgeId=user.tFansInfo.lBadgeId,iBadgeType=user.tFansInfo.iBadgeType,iVFlag=user.tFansInfo.iVFlag,sNickName=user.sNickName,iUserLevel=user.iUserLevel;try{sNickName=decodeURIComponent(_.escape(sNickName))}catch(e){sNickName=_.escape(sNickName)}__p+='\r\n        <div class="seat-item">\r\n            ',iNobleLevel>0&&(__p+='<span class="noble-icon noble-level-'+(null==(__t=iNobleLevel)?"":__t)+'"></span>'),__p+="\r\n            ",user.tGuildMemInfo.iGuildVip>0&&(__p+='<span class="icon-guildVip"></span>'),__p+="\r\n            "+(null==(__t=creatGuardIcon(iGuardLevel))?"":__t)+"\r\n            "+(null==(__t=fansIcon.create(iBadgeLevel,sBadgeName,lBadgeId,iBadgeType))?"":__t)+'\r\n            <span class="peo-name J_name">'+(null==(__t=sNickName)?"":__t)+"</span>\r\n            ",iVFlag&&(__p+=" "+(null==(__t=sVLogo?'<img class="vfans-icon-custom" src="'+TT.trimUrl(sVLogo).replace(".png","_3.png")+'" />':'<span class="vfans-icon"></span>')?"":__t)+" "),__p+="\r\n            ",iUserLevel&&(__p+='<span class="level-icon level-icon'+(null==(__t=iUserLevel)?"":__t)+'"></span>'),__p+="\r\n        </div>\r\n"}__p+="\r\n"}__p+="\r\n"}return __p},cssText='@charset "UTF-8";.vipSeat .vipSeat-cont{max-height:320px}.vipSeat .vipSeat-list .seat-item{padding:4px 0 4px 10px;line-height:24px;zoom:1}.vipSeat .vipSeat-list .seat-item:before,.vipSeat .vipSeat-list .seat-item:after{display:table;content:""}.vipSeat .vipSeat-list .seat-item:after{clear:both}.vipSeat .vipSeat-list .seat-item:hover{background:#f3f3f3}.vipSeat .vipSeat-list .seat-item .sh-name{color:#fe620f;float:left;width:58px;font-size:10px}.vipSeat .vipSeat-list .seat-item .fans-icon{float:left;margin:0 3px 0 0}.vipSeat .vipSeat-list .seat-item .peo-name{float:left;max-width:110px;font-size:12px;white-space:nowrap;word-wrap:normal;overflow:hidden;-ms-text-overflow:ellipsis;text-overflow:ellipsis;cursor:pointer}.vipSeat .vipSeat-list .seat-item .noble-icon{float:left;margin:2px 3px 0 0}.vipSeat .vipSeat-list .seat-item .sh-icon{float:left;margin:3px 3px 0 0}.vipSeat .vipSeat-list .seat-item .icon-guildVip{float:left;margin:3px 3px 0 0;width:16px;height:18px;background:url(https://a.msstatic.com/huya/main/widget/vipSeat/img/icon-guildVip_688e16b.png)}.vipSeat .vipSeat-list .seat-item .vfans-icon{float:left;margin:3px 0 0 2px;width:18px;height:16px;overflow:hidden;background:url(https://a.msstatic.com/huya/main/img/vfans-icon_4e6847a.png?__sprite)}.vipSeat .vipSeat-list .seat-item .vfans-icon-custom{float:left;margin-left:3px}.vipSeat .vipSeat-list .seat-item .level-icon{float:left;margin:6px 0 0 4px}.vipSeat .vipSeat-tips{line-height:32px;color:#999;text-align:center}.vipSeat .vipSeat-buy{line-height:32px;background:#FFF9E0;text-align:center;color:#333}.vipSeat .vipSeat-buy a{padding-left:.8em;color:#f80}.vipSeat .vipSeat-buy a:hover{text-decoration:none;color:#f90}.vipSeat .vipSeat-buy a i{font-family:\\5b8b\\4f53}.vipSeat.vipSeat-empty .vipSeat-buy{background:transparent;padding-top:32px}.vipSeat.vipSeat-less .vipSeat-buy{background:transparent}',vipSeat=$("#J_vipSeat"),seats=(vipSeat.find(".vipSeat-cont"),vipSeat.find(".vipSeat-list")),tips=vipSeat.find(".vipSeat-tips"),size=0,scrollbar=null,scrollbarSetup=tools.debounce(function(){scrollbar&&scrollbar.destroy(),scrollbar=vipSeat.find(".vipSeat-cont").jScrollPane({scrollbarWidth:8,mouseWheelSpeed:20,isOutsideNotPrevent:!1}).data("jsp")},100);return tools.importStyle(cssText,"style_vipSeat"),vipSeat.show(),render(viper),bind(),{update:update}},visible=2===tab.getIndex();tab.change(function(){visible=2===tab.getIndex()});var rank=null,update=function(){function e(e){rank?rank.update(e):rank=new Rank(e)}var t=null;return tab.change(function(){visible&&t&&(e(t),t=null)}),function(i){i&&i.list&&"number"==typeof i.total&&(visible?e(i):t=i)}}();update(vipModel.data),vipModel.on("change",update)});